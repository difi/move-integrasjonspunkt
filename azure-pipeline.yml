resources:
  repositories:
    - repository: efm-eproc-pipeline
      type: github
      name: felleslosninger/efm-eproc-pipeline
      endpoint: felleslosninger
      ref: development

extends:
  template: build-and-deploy-template.yml@efm-eproc-pipeline
  parameters:
    environmentRepository: git://eformidling/eformidling
    jdkVersion: 1.8
    buildDockerArtifact: false
    preDockerComposePush:
      - task: PublishCodeCoverageResults@1
        inputs:
          codeCoverageTool: 'JaCoCo'
          summaryFileLocation: '$(Build.SourcesDirectory)/jacoco.xml'
#          reportDirectory: '$(Build.SourcesDirectory)/integrasjonspunkt/target/site/jacoco'
          pathToSources: '$(Build.SourcesDirectory)'
          additionalCodeCoverageFiles: '$(Build.SourcesDirectory)/jacoco.exec'

trigger:
  batch: true
  branches:
    include:
      - development
      - release-*
      - master